# 锁，到底有什么用

一般情况下，常规的回答是保护共享资源的访问的互斥性，这个说的没什么问题，但也说的比较宽泛，这里具体聊聊在具体设计一个类的时候，类中的成员锁能完成什么功能，以及如何规划锁的数量和位置。

## 保证成员变量的访问互斥性

这个没什么好说的，在类的成员函数里，在访问要保护的成员变量的上下文加入加锁和解锁

## 保证成员函数的调用互斥性

如果想让A()和B()在多线程调用的时候，保持串行化执行—，也就是说，即使A()和B()的调用分布在不同的线程上，A()和B()的执行也必须串行化。
怎么实现呢？使用同一个互斥锁，在A()开始时加锁，结束时解锁，B()开始时加锁，结束时解锁

## 锁的数量

为了少出错，貌似保持N个区域的互斥，就需要N把锁，但是实际情况下根据具体的逻辑，还是可以优化的，不过感觉n:n是最不容易出错的