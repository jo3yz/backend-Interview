## 什么是DNS
就像是一个负责域名->IP的去中心化的分布式数据库

## 一次DNS发生了什么（就近找对应顶级域名的服务器）
1. 本地的 DNS 客户端向 DNS 解析器发出解析 draveness.me 域名的请求；
2. DNS 解析器首先会向就近的根DNS服务器“.”，请求顶级域名“.me”的DNS服务的地址；
3. 拿到顶级域名 DNS 服务“me”的地址之后会向顶级域名服务请求负责 dravenss.me. 域名解析的命名服务；
4. 得到授权的 DNS 命名服务时，就可以根据请求的具体的主机记录直接向该服务请求域名对应的 IP 地址；
5. 但是对于DNS解析器的中间过程，可能是递归的，可能一次结果返回的是需要查询的下一个服务器地址，而不是解析结果

## 域名的命名空间和解析服务器的结构
- 都是树形的
- 但是每层负责域名解析的DNS服务器的职责是不同的

## 大部分使用的是UDP
- DNS查询负载的数据包本身就很小，再使用TCP的话连接本身的成本比数据还高
- TCP三次握手（100字节+），四次挥手（100字节+）
- UDP的额外成本只有以太网头+IP头+校验和
- 此外如果是递归的查询，这个成本会被成倍的放大

## 什么时候用TCP呢？
- 如果DNS的包变得比较大，就可以用
- 虽然UDP一次可以发64K，但是会因为MTU的限制而分片，这样丢包率就会大幅度增加，而且不能保证分片后数据的顺序一致
- DNS包变大之后，TCP的通信成本的比例就会下降，显得更合理